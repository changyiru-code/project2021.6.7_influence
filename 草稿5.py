
import pandas as pd
from datetime import datetime
import time
# 计算时间差的函数
mod_times=[1615310538550, 1615310524557, 1615307071911, 1615301762864, 1615046133843, 1614968634568, 1614904628986, 1614677330063, 1614672832777, 1614666100552, 1614665270622, 1614664483076, 1614663634063, 1614663405851, 1614660985210, 1614651743813, 1614606598591, 1613474737000, 1612915368741, 1612886929359, 1612828027047, 1612827615297, 1612792673645, 1612777410073, 1612661266480, 1612660820296, 1612401729421, 1612400577221, 1612158339709, 1612149010696, 1612146980206, 1612146104631, 1612145963885, 1612145802032, 1611999887604, 1611926127123, 1611924256802, 1611921092598, 1611921073427, 1611862491357, 1611455944747, 1611328776527, 1611282637441, 1611263737927, 1611061934446, 1611056051940, 1611056051421, 1611046416074, 1610944723000, 1610686985011, 1610667996000, 1610428238134, 1610413673809, 1610169970895, 1610169936626, 1610169084435, 1609766323716, 1609214675783, 1609170399025, 1609165532463, 1609127004230, 1609074860813, 1608971083942, 1608971073612, 1608971064437, 1608964031624, 1608963598034, 1608963543499, 1608962817866, 1608962817320, 1608962799945, 1608962786136, 1608962767799, 1608962763630, 1608947004173, 1608946732465, 1608946714485, 1608945816397, 1608945769804, 1608945746977, 1608944900086, 1608944891830, 1608900531263, 1608900153648, 1608900091764, 1608900013569, 1608899835994, 1608899507217, 1608899449649, 1608899338829, 1608899182862, 1608898948305, 1608898917900, 1608898901584, 1608898804200, 1608898745771, 1608895544887, 1608893937565, 1608893666656, 1608893498973, 1608893418758, 1608893336677, 1608893335677, 1608893333993, 1608893325460, 1608893317026, 1608893234145, 1608891734658, 1608891224323, 1608890192640, 1608889671803, 1608888898746, 1608870653143, 1608864672776, 1608599906792, 1608539742520, 1608519088832, 1608472337526, 1608468487374, 1608468465194, 1608430052236, 1608371228941, 1608309088577, 1608254418640, 1608219103309, 1608210481524, 1608199807745, 1608192068704, 1608170568651, 1608140218039, 1608122399633, 1608106888112, 1608093278961, 1608083370790, 1608073764662, 1608057855525, 1608035529271, 1607994290645, 1607988062031, 1607947103434, 1607929284788, 1607928151275, 1607867098154, 1607850241533, 1607755686450, 1607705474147, 1607696972372, 1607688202169, 1607669915177, 1607527132318, 1607519443776, 1607480658932, 1607389429691, 1607387937145, 1607304162752, 1607269715399, 1607262698975, 1607221605886, 1607166382927, 1607164942337, 1607078063847, 1607067788241, 1607061673407, 1607059190918, 1607057245724, 1607055230781, 1607055120377, 1607054711826, 1607054659327, 1607029416853, 1606989246254]
# 计算时间差的函数
def timecha(time1, time2):
    diff_day = (time1 - time2).days
    diff_sec = (time1 - time2).seconds
    m, s = divmod(diff_sec, 60)  # 时间差是diff_day天h时m分s秒
    h, m = divmod(m, 60)
    h_cha = diff_day * 24 + h   # 时间差，以时为单位
    if (h == 0 and (m != 0 or s != 0)) or m > 30:
        T = h_cha + 1   # 如果时间差超过12小时，则按一天算，不足12时不按一天算
    else:
        T = h_cha
    return T

def cha1(mod_times):
    """13位时间戳相减转日期"""
    mod_times=[time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(x/1000)) for x in mod_times]
    mod_times = [datetime.strptime(x, '%Y-%m-%d %H:%M:%S') for x in mod_times]  # 改str类型为datetime.datetime类型
    print(mod_times)
    max_time = max(mod_times)  # 该话题的结束时间
    min_time = min(mod_times)  # 该话题的开始时间
    li_t = timecha(max_time, min_time)   # 该话题的持续时间
    print(li_t)
cha1(mod_times)



